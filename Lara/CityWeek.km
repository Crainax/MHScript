[General]
ScreenX=1440
ScreenY=2560
Times=0

[Script]
Dim tarX,tarY //Ŀ��
Dim logoX,logoY,intX,intY //��Ŀ�ĵز�ֵ
Dim cY,consecutiveTimes,consecutiveMax //����������жϽ�ɫ�ǲ���û��X��Y��仯��
Dim tolerance,tolLoc //�����ƶ����ݲ�,0������ȷ�ƶ�,������Ǿֲ�����
Dim waterTime,fireTime,seedTime,fountainTime,a
//������:ˮ�ͷ�(63,122),�չ�(60,140),��Ȫ(164,116),���ͷ�(108,128),����(108,140)



Sub Move()  //��ȷ���ƶ�
    consecutiveTimes = -1  //��ʼ������ָ�����ж�
    consecutiveMax   = 3   //����Ĭ��ֵΪ4
    while  1 > 0
        FindPic 0,1650,300,1900,"E:\MHImg\MapAnchor.bmp",000000,1.00,0,logoX,logoY
        FindPic 0,1650,300,1900,"E:\MHImg\Me.bmp",000000,1.00,0,intX,intY

        if intX < 0 Then //�����ܵ��˱߽�  ����һ��
            KeyDown Left
            DelayRandom 1000,1500
            KeyUp Left
            FindPic 0,1650,300,1900,"E:\MHImg\Me.bmp",000000,1.00,0,intX,intY
            if intX < 0 Then //�����˻���û�ҵ�,������
                KeyDown Right
                DelayRandom 1000,1500
                KeyUp Right
                FindPic 0,1650,300,1900,"E:\MHImg\Me.bmp",000000,1.00,0,intX,intY
            End if
        End if

        intX = intX - logoX
        intY = intY - logoY
        if consecutiveTimes >= 0 Then //Ŀǰ���ڿ����жϽ���Ľ׶�
            if intY == cY Then //Y��û�仯��
                consecutiveTimes = consecutiveTimes + 1
                if consecutiveTimes >= consecutiveMax Then
                    consecutiveTimes	= -1	//�ж�Ϊ�Ѿ����
                    consecutiveMax		= 3		//��λ������ж�ֵ
                End If
            else
                cY = intY
                consecutiveTimes = 0
            End If
        else //��������
            if tolerance > 4 Then
                tolLoc = tolerance
            else  //���ߵ�Ĭ��Ϊ4
                tolLoc = 4
            End If
            if intX < (tarX-24) Then //���Ҷ�����
                consecutiveTimes = 0 //���������ж�
                cY = intY
                DelayRandom 15,25
                KeyDown Right
                DelayRandom 50,51
                KeyDown Space
                DelayRandom 80,81
                KeyUp Space
                DelayRandom 30,31
                KeyDown Space
                DelayRandom 75,76
                KeyUp Space
                DelayRandom 85,86
                KeyUp Right
                DelayRandom 41,42
                KeyDown F
                DelayRandom 113,115
                KeyUp F
                DelayRandom 146,151
            Else If intX > (tarX+24) Then //���������
                consecutiveTimes = 0 //���������ж�
                cY = 0
                DelayRandom 15,25
                KeyDown Left
                DelayRandom 50,51
                KeyDown Space
                DelayRandom 80,81
                KeyUp Space
                DelayRandom 30,31
                KeyDown Space
                DelayRandom 75,76
                KeyUp Space
                DelayRandom 85,86
                KeyUp Left
                DelayRandom 41,42
                KeyDown F
                DelayRandom 113,115
                KeyUp F
                DelayRandom 146,151
            Else If intX < (tarX-tolLoc) Then //������
                KeyDown Right
            Else If intX > (tarX+tolLoc) Then //������
                KeyDown Left
            else
                KeyUp Right
                KeyUp Left
                If intY < tarY Then //�������Ŀ��֮��,������(Y�������෴�ȽϷ�)
                    consecutiveTimes = 0 //���������ж�
                    cY = intY
                    DelayRandom 12,13
                    KeyDown Down
                    DelayRandom 76,77
                    KeyDown Space
                    DelayRandom 128,130
                    KeyUp Space
                    DelayRandom 453,454
                    KeyUp Down
                    DelayRandom 32,33
                Else If intY > tarY Then //�������Ŀ��֮��,������(Y�������෴�ȽϷ�)
                    consecutiveTimes = 0 //���������ж�
                    cY = intY
                    if intY > (tarY+25) Then	//>=26�����͹�������
                        consecutiveMax = 8 //�ӳ�һ�㽵���ж�
                        KeyDown Ctrl
                        DelayRandom 328,430
                        KeyUp Ctrl
                    else
                        consecutiveMax = 6 //�ӳ�һ�㽵���ж�
                        KeyDown Alt
                        DelayRandom 328,430
                        KeyUp Alt
                    End If
                else
                    if tolerance < 4 Then //���̶�С��4����ҪС�鲽
                        //Y��Ҳ�����,��X����
                        If intX < (tarX-tolerance) Then //����С�鲽
                            KeyDown Right
                            DelayRandom 10,15
                            KeyUp Right
                        Else If intX > (tarX+tolerance) Then //����С�鲽
                            KeyDown Left
                            DelayRandom 10,15
                            KeyUp Left
                        else
                            Exit Sub
                        End If
                    else //���̶ȴ��ڵ���4����ֱ�ӽ���
                        Exit Sub
                    End If
                End If
            End If
        End If
        Delay 5
    Wend
End Sub

Sub SpellList() //����Ӽ���
 FindPic 800,2300,1439,2559,"E:\MHImg\BT_Spider.bmp",000000,1.00,0,intX,intY
        if intX >= 0 Then //��֩��
            KeyDown H
            DelayRandom 105,107
            KeyUp H
            DelayRandom 929,939
        else
            FindPic 800,2300,1439,2559,"E:\MHImg\BT_Lieyang.bmp",000000,1.00,0,intX,intY
            if intX >= 0 Then //������
                KeyDown Y
                DelayRandom 105,107
                KeyUp Y
                DelayRandom 811,813
            else
                FindPic 800,2300,1439,2559,"E:\MHImg\LL_V1.bmp",000000,1.00,0,intX,intY
                if intX >= 0 Then //��V1
                    KeyDown G
                    DelayRandom 123,130
                    KeyUp G
                    DelayRandom 387,400
                else
                    FindPic 800,2300,1439,2559,"E:\MHImg\LL_V2.bmp",000000,1.00,0,intX,intY
                    if intX >= 0 Then //��V2
                        KeyDown C
                        DelayRandom 152,160
                        KeyUp C
                        DelayRandom 822,912
                    else
                        FindPic 800,2300,1439,2559,"E:\MHImg\LL_V3.bmp",000000,1.00,0,intX,intY
                        if intX >= 0 Then //��V3
                            KeyDown V
                            DelayRandom 123,130
                            KeyUp V
                            DelayRandom 899,909
                        else
                            FindPic 800,2300,1439,2559,"E:\MHImg\LL_V4.bmp",000000,1.00,0,intX,intY
                            if intX >= 0 Then //��V4
                                KeyDown B
                                DelayRandom 105,107
                                KeyUp B
                                DelayRandom 712,780
                            else
                                FindPic 800,2300,1439,2559,"E:\MHImg\GelanBless.bmp",000000,1.00,0,intX,intY
                                if intX >= 0 Then //��Ů��ף��
                                    KeyDown 5
                                    DelayRandom 134,142
                                    KeyUp 5
                                    DelayRandom 512,519
                                else
                                    FindPic 800,2300,1439,2559,"E:\MHImg\BT_Wugong.bmp",000000,1.00,0,intX,intY
                                    if intX >= 0 Then //���乫
                                        KeyDown 4
                                        DelayRandom 105,107
                                        KeyUp 4
                                        DelayRandom 899,909
                                    else //ʲô��û�о��չ�һ��
                                        KeyDown F
                                        DelayRandom 811,892
                                        KeyUp F
                                        DelayRandom 246,249
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If

            End If
        End If
End Sub


waterTime    = 0  //�ϴη��ʱ��
fireTime     = 0  //�ϴλ��ʱ��
seedTime     = 0  //�ϴ����ӵ�ʱ��
fountainTime = 0  //�ϴ���Ȫ��ʱ��

while 1 > 0
    FindPic 800,2300,1439,2559,"E:\MHImg\BT_Water.bmp",000000,1.00,0,intX,intY
    a = GetTimeStamp() - fountainTime
    if a > 55 or intX >= 0 then //������Ȫ��
        tarX = 164
        tarY = 116
        tolerance = 2
        Call Move()
        DelayRandom 56,58
        KeyDown Right
        DelayRandom 62,68
        KeyUp Right
        DelayRandom 106,109
        KeyDown Down
        DelayRandom 95,96
        KeyDown 1
        DelayRandom 194,196
        KeyUp 1
        DelayRandom 66,67
        KeyUp Down
        DelayRandom 712,721
        fountainTime = GetTimeStamp()
    End If

    a = GetTimeStamp() - waterTime
    if a > 14 then //���Է�ˮ��
        tarX = 63
        tarY = 122
        tolerance = 4
        Call Move()
        DelayRandom 56,58
        KeyDown Left
        DelayRandom 114,118
        KeyUp Left
        DelayRandom 386,398
        KeyDown A
        DelayRandom 137,142
        KeyUp A
        DelayRandom 249,257
        KeyDown S
        DelayRandom 140,145
        KeyUp S
        DelayRandom 460,486
        KeyDown Left
        DelayRandom 90,94
        KeyUp Left
        DelayRandom 253,258
        waterTime = GetTimeStamp()
    End If

    a = GetTimeStamp() - fireTime
    if a > 14 then //���ԷŻ���
        tarX = 108
        tarY = 128
        tolerance = 4
        Call Move()
        DelayRandom 56,58
        KeyDown Right
        DelayRandom 116,120
        KeyUp Right
        DelayRandom 184,190
        KeyDown A
        DelayRandom 135,140
        KeyUp A
        DelayRandom 239,247
        KeyDown S
        DelayRandom 97,100
        KeyUp S
        DelayRandom 494,500
        KeyDown Up
        DelayRandom 138,143
        KeyUp Up
        DelayRandom 352,375
        fireTime = GetTimeStamp()
    else

        a = GetTimeStamp() - seedTime
        if a > 14 then //���Է�������
            tarX = 108
            tarY = 140
            tolerance = 6
            Call Move()
            DelayRandom 56,58
            KeyDown Down
            DelayRandom 95,98
            KeyDown `
            DelayRandom 251,259
            KeyUp `
            DelayRandom 119,123
            KeyUp Down
            DelayRandom 455,469
            seedTime = GetTimeStamp()
        else //ǰ��ţ���ط��ż���
            tarX = 60
            tarY = 140
            tolerance = 8
            Call Move()
            DelayRandom 56,58
            Call SpellList()
            DelayRandom 155,169
        End If

    End If


Wend