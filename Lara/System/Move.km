[General]
ScreenX=1440
ScreenY=2560
Times=0

[Script]
Dim x1,x2,y1,y2 // ��������:С��ͼ������
Dim x3,x4,y3,y4 // 2������:������/Ģ������
Dim xEnd,yEnd //��Ļ���½Ƕ���
Dim tarX,tarY //Ŀ��
Dim logoX,logoY,intX,intY //��Ŀ�ĵز�ֵ
Dim cY,consecutiveTimes,consecutiveMax //����������жϽ�ɫ�ǲ���û��X��Y��仯��
Dim tolerance,tolLoc //�����ƶ����ݲ�,0������ȷ�ƶ�,������Ǿֲ�����
//Ŀǰ�Ѿ����һ������������32��X��(ƽ��)
//�������Ե�:������(127,150),����(173,128),�Ҷ�������(146,106),�Ҷ���������(120,100),���ϲ�������(56,122),����(22,108),��վλ(105,139)


Sub Move()  //��ȷ���ƶ�
    consecutiveTimes = -1  //��ʼ������ָ�����ж�
    consecutiveMax   = 3   //����Ĭ��ֵΪ4
    while  1 > 0
        FindPic x1,y1,x2,y2,"E:\MHImg\MapAnchor.bmp",000000,1.00,0,logoX,logoY
        FindPic x1,y1,x2,y2,"E:\MHImg\Me.bmp",000000,1.00,0,intX,intY

        if intX < 0 Then //�����ܵ��˱߽�  ����һ��
            TracePrint û�ҵ���,��ʼ�������Բ�
            KeyDown Left
            DelayRandom 1000,1500
            KeyUp Left
            FindPic x1,y1,x2,y2,"E:\MHImg\Me.bmp",000000,1.00,0,intX,intY
            if intX < 0 Then //�����˻���û�ҵ�,������
                KeyDown Right
                DelayRandom 1000,1500
                KeyUp Right
                FindPic x1,y1,x2,y2,"E:\MHImg\Me.bmp",000000,1.00,0,intX,intY
            End if
        End if

        intX = intX - logoX
        intY = intY - logoY
        if consecutiveTimes >= 0 Then //Ŀǰ���ڿ����жϽ���Ľ׶�
            if intY == cY Then //Y��û�仯��
                consecutiveTimes = consecutiveTimes + 1
                TracePrint �����ж�: & consecutiveTimes
                if consecutiveTimes >= consecutiveMax Then
                    consecutiveTimes	= -1	//�ж�Ϊ�Ѿ����
                    consecutiveMax		= 3		//��λ������ж�ֵ
                    TracePrint �ж��Ѿ����
                End If
            else
                cY = intY
                consecutiveTimes = 0
                TracePrint �����ж�: & consecutiveTimes
            End If
        else //��������
            if tolerance > 4 Then
                tolLoc = tolerance
            else  //���ߵ�Ĭ��Ϊ4
                tolLoc = 4
            End If
            if intX < (tarX-24) Then //���Ҷ�����
                consecutiveTimes = 0 //���������ж�
                cY = intY
                TracePrint ����
                DelayRandom 15,25
                KeyDown Right
                DelayRandom 50,51
                KeyDown Space
                DelayRandom 80,81
                KeyUp Space
                DelayRandom 30,31
                KeyDown Space
                DelayRandom 75,76
                KeyUp Space
                DelayRandom 85,86
                KeyUp Right
                DelayRandom 41,42
                KeyDown F
                DelayRandom 113,115
                KeyUp F
                DelayRandom 146,151
            Else If intX > (tarX+24) Then //���������
                consecutiveTimes = 0 //���������ж�
                cY = 0
                TracePrint ����
                DelayRandom 15,25
                KeyDown Left
                DelayRandom 50,51
                KeyDown Space
                DelayRandom 80,81
                KeyUp Space
                DelayRandom 30,31
                KeyDown Space
                DelayRandom 75,76
                KeyUp Space
                DelayRandom 85,86
                KeyUp Left
                DelayRandom 41,42
                KeyDown F
                DelayRandom 113,115
                KeyUp F
                DelayRandom 146,151
            Else If intX < (tarX-tolLoc) Then //������
                KeyDown Right
            Else If intX > (tarX+tolLoc) Then //������
                KeyDown Left
            else
                KeyUp Right
                KeyUp Left
                If intY < tarY Then //�������Ŀ��֮��,������(Y�������෴�ȽϷ�)
                    consecutiveTimes = 0 //���������ж�
                    cY = intY
                    TracePrint ����һ��
                    DelayRandom 12,13
                    KeyDown Down
                    DelayRandom 76,77
                    KeyDown Space
                    DelayRandom 128,130
                    KeyUp Space
                    DelayRandom 453,454
                    KeyUp Down
                    DelayRandom 32,33
                Else If intY > tarY Then //�������Ŀ��֮��,������(Y�������෴�ȽϷ�)
                    consecutiveTimes = 0 //���������ж�
                    cY = intY
                    if intY > (tarY+25) Then	//>=26�����͹�������
                        consecutiveMax = 8 //�ӳ�һ�㽵���ж�
                        TracePrint ����һ�� //TODO:�Ӹ�ɲ��
                        KeyDown Ctrl
                        DelayRandom 328,430
                        KeyUp Ctrl
                    else
                        consecutiveMax = 6 //�ӳ�һ�㽵���ж�
                        TracePrint ����һ��
                        KeyDown Alt
                        DelayRandom 328,430
                        KeyUp Alt
                    End If
                else
                    if tolerance < 4 Then //���̶�С��4����ҪС�鲽
                        //Y��Ҳ�����,��X����
                        If intX < (tarX-tolerance) Then //����С�鲽
                            KeyDown Right
                            DelayRandom 10,15
                            KeyUp Right
                        Else If intX > (tarX+tolerance) Then //����С�鲽
                            KeyDown Left
                            DelayRandom 10,15
                            KeyUp Left
                        else
                            Exit Sub
                        End If
                    else //���̶ȴ��ڵ���4����ֱ�ӽ���
                        Exit Sub
                    End If
                End If
            End If
        End If
        Delay 5
    Wend
End Sub

//�ֱ��ʳ�ʼ��
GetScreenResolution intX, intY
if intX > intY then //�����Ļ
    x1 = 700
    y1 = 550
    x2 = 1650
    y2 = 850
else //������Ļ
    x1 = 0
    y1 = 1650
    x2 = 300
    y2 = 1900
End If
tolLoc = 1
GetFileLine tarX,Move.Conf,tolLoc		//�ļ�����
tolLoc = 2
GetFileLine tarY,Move.Conf,tolLoc		//�ļ�����
tolLoc = 3
GetFileLine tolerance,Move.Conf,tolLoc	//�ļ�����
TracePrint ǰ��[ & tarX & , & tarY & ],���̶� & tolerance
//tolerance = 4 //���̶�,4Ϊ�Ƽ�ֵ
Call Move()
MsgBox ���Խ���